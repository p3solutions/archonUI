<app-navbar *ngIf="showNavBar"></app-navbar>
<div class="row" id="analysis-view">
  <div class="col-md-3" id="table-list">
    <div class="card">
      <div class="card-body">
        <div class="row" id="title-name">
          <h2>Tables
            <span [ngClass]="{'archon-loading-icon' : !isAvailable}" id="loading-icon"></span>
          </h2>
        </div>
        <input type="text" class="form-control search-input" placeholder="Search" [(ngModel)]="query" id="listSearch">
        <span class="glyphicon glyphicon-search form-control-feedback"></span>
        <div class="tablename-list da-table-parent">
          <div class="list-group" id="list-tab" role="tablist" *ngFor="let table of tableList | searchTable:query">
            <button type="button" class="btn btn-default list-group-item da-table" (click)="highlightTable($event, true, table)">{{table.tableName}}
              <i class="fa fa-angle-right unselected"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-8 col-md-offset-2.5">
    <div class="card">
      <app-relationship-info [serviceActionType]="serviceActionType"
       [tableName]="tableName" [homeStage]="homeStage"
      [dataAModal]="dataAModal" [isRelationShipAvailable]="isRelationShipAvailable" 
      [relationshipInfo]="relationshipInfo"></app-relationship-info>
<!-- Data Analyzer -->
      <div *ngIf="dataAModal" class="">
        <div class=" {{newWSinfo ? 'msg-modal' : ''}}" role="worskspace">
          <div class="text-left">
            <div class="modal-header">
              <div class="col-md-1 back-arrow">
                <a (click)="gotoBack()" data-tooltip="Back">
                  <i class="fa fa-arrow-left fa-lg" aria-hidden="true"></i>
                </a>
              </div>
              <h4 class="modal-title">Data Analyzer</h4>
            </div>
      
            <div class="modal-body row">
            <!-- carousel -->
              <div id="dataAModal-carousel" class="carousel slide" data-ride="carousel" data-interval="false">
                <!-- Indicators -->
                <ul *ngIf="!newWSinfo" class="multi-step-bars">
                  <li > 
                    <span id="progress-bar" class="bar-expand width-5-pc"></span>
                    <em class="col-md-4 text-center">Primary Column</em>
                    <em class="col-md-4 text-center">Secondary Table &#38; Column selection</em>
                    <em class="col-md-4 text-center">Data Analysis</em>
                  </li>
                </ul>
      
                <ol class="only carousel-indicators hide">
                  <li data-target="#createWSModal-carousel" data-slide-to="0" class="active"></li>
                  <li data-target="#createWSModal-carousel" data-slide-to="1"></li>
                  <li data-target="#createWSModal-carousel" data-slide-to="2"></li>
                  <li data-target="#createWSModal-carousel" data-slide-to="3"></li>
                </ol>
                <!-- Wrapper for slides -->
                <div class="carousel-inner" role="listbox">
      
                  <div step="0" class="item active form-group">
                    <div class="panel-body dataA-panel-body">
                      <div class="tabular-div col-md-12">
                        <div class="col-md-9 tabular-div-row p-0">
                          <div class="tabular-div-column column-header">
                              Number of Rows to consider for Analysis
                              <input type="number" class="m-l-10" [(ngModel)]="analysisRowCount" min="1" max="{{primColArray.length}}">
                          </div>
                        </div>
                      </div>
                      <div class="col-md-12">
                        {{selectedPrimColMap.size}} out of {{primColArray.length}} selected
                      </div>
                      <div class="tabular-div col-md-4 dataA-scrollable-div">
                        <div class="col-md-12 p-0 tabular-div-row">
                          <div class="col-md-8 tabular-div-column column-header" title="Primary Column">
                            Primary Column
                            <span class="col-loader" [ngClass]="{'archon-loading-icon' : primColArray.length === 0}"></span>
                          </div>
                          <div class="col-md-4 tabular-div-column column-header" title="Suggestion">
                            Suggestion
                          </div>
                        </div>
                        <div class="col-md-12 p-0 tabular-div-row" *ngFor="let pColumn of primColArray">
                          <div class="col-md-8 tabular-div-column trim-text" title="{{pColumn.column_name}}">
                          <input id="{{pColumn}}" type="checkbox" (change)="toggleColSelection($event, true, pColumn)" class="m-r-10">
                            {{pColumn.column_name}}
                          </div>
                          <div class="col-md-4 tabular-div-column" title="">
                            {{pColumn.confidence_score ? pColumn.confidence_score : 0}} %
                          </div>
                        </div>
                      </div>
                      
                    </div>
                  </div>
      
                  <div step="1" class="item form-group second second-last">
                    <div class="panel-body dataA-panel-body">
                      <div class="tabular-div col-md-12">
                        <div class="col-md-9 tabular-div-row p-0">
                          <div class="tabular-div-column column-header">
                              Number of Rows to consider for Analysis
                              <input type="number" class="m-l-10" [(ngModel)]="analysisRowCount" min="1" max="{{secTblArray.length > 0 ? secTblArray.length : null}}">
                          </div>
                        </div>
                      </div>
                      <div class="col-md-6" style="height: 295px;">
                        <div class="col-md-12">
                          {{selectedSecTbl.size}} out of {{secTblArray.length}} selected
                        </div>
                        <div class="tabular-div col-md-8 p-0 dataA-scrollable-div">
                          <div class="col-md-12 p-0 tabular-div-row">
                            <div class="col-md-12 tabular-div-column column-header" title="Secondary Column">
                              Secondary Table
                            </div>
                          </div>
                          <div class="da-table-parent">
                            <div class="col-md-12 p-0 tabular-div-row" *ngFor="let secTbl of secTblArray;">
                              <div class="col-md-12 tabular-div-column cur-p da-table trim-text" title="{{secTbl.table_name}}" (click)="highlightTable($event, false, secTbl)">
                                <input id="{{prefixSecTblId + (secTbl.table_name | lowercase)}}" type="checkbox" (change)="toggleSecTblSelection($event, secTbl)" class="m-r-10">
                                {{secTbl.table_name}}
                                <i class="fa fa-angle-right unselected"></i>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div *ngIf="secColArray.length > 0" class="col-md-6" style="height: 295px;">
                          <div class="col-md-12">
                            {{selectedSecColMap.size}} out of {{secColArray.length}} selected
                          </div>
                          <div class="tabular-div col-md-8 p-0 dataA-scrollable-div">
                            <div class="col-md-12 p-0 tabular-div-row">
                              <div class="col-md-8 tabular-div-column column-header" title="Secondary Column">
                                Secondary Columns
                                <span class="col-loader" [ngClass]="{'archon-loading-icon' : secColArray.length === 0}"></span>
                              </div>
                              <div class="col-md-4 tabular-div-column column-header" title="Suggestion">
                                Suggestion
                              </div>
                            </div>
                            <div class="col-md-12 p-0 tabular-div-row" *ngFor="let sColumn of secColArray">
                              <div class="col-md-8 tabular-div-column trim-text" title="{{sColumn.column_name}}">
                                <input id="{{sColumn.table_name + secTblColJoiner + sColumn.column_name}}" type="checkbox" (change)="toggleColSelection($event, false, sColumn)"
                                checked="{{sColumn.selected ? 'checked' : null}}" class="m-r-10">
                                {{sColumn.column_name}}
                              </div>
                              <div class="col-md-4 tabular-div-column" title="">
                                {{sColumn.confidence_score ? sColumn.confidence_score : 0}} %
                              </div>
                            </div>
                          </div>

                      </div>
                        
                    </div>
                  </div>
      
                  <div step="2" class="item form-group final">
                    <div class="panel-body dataA-panel-body">

                    </div>
                  </div>

                  <!-- <div step="3" class="item form-group final">
                  </div>       -->
  
                  <div class="item form-group message">
                  </div>
              
                <!-- Controls -->
                <a hidden class="left carousel-control" id="prev-slide" href="#dataAModal-carousel" role="button" data-slide="prev">
                  <span class="sr-only">Previous</span>
                </a>
                <a hidden class="right carousel-control" id="next-slide" href="#dataAModal-carousel" role="button" data-slide="next">
                  <span class="sr-only">Next</span>
                </a>
              </div>
            <!-- / end of Carousel -->
            </div>
            <div class="modal-footer {{newWSinfo ? 'msg-footer' : ''}}">
              <!-- <button type="button" id="cancel-btn" class="btn btn-secondary cancel" data-dismiss="modal">Cancel</button> -->
              <button type="button" id="prev-btn" class="btn btn-primary hide" (click)="prevStep($event)">Previous</button>
              <button type="button" id="next-btn" class="btn btn-primary" (click)="nextStep($event)"
               disabled="{{enableNextBtn ? null : 'disabled'}}" >&nbsp;&nbsp;&nbsp;Next&nbsp;&nbsp;&nbsp;</button>
              <button type="button" id="analyse-btn" class="btn btn-primary hide" (click)="dataAnalyse()" disabled>Analyse</button>
              <!-- <button type="button" id="ok-btn" class="btn btn-primary hide" (click)="resetCarousel()">Done</button> -->
            </div>
      
          </div>
        </div>
      </div>
      


    </div>
  </div>
</div>

